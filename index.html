<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç - –ó—ä–±–æ–ª–µ–∫–∞—Ä—Å–∫–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞. –ó–∞–ø–∞–∑–µ—Ç–µ —á–∞—Å –æ–Ω–ª–∞–π–Ω –±—ä—Ä–∑–æ –∏ –ª–µ—Å–Ω–æ.">
  <meta name="theme-color" content="#2563eb">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç">
  
  <title>–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="assets/logo.png">
  <link rel="apple-touch-icon" href="assets/logo.png">
  
  <!-- Google Fonts - Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Styles -->
  <link rel="stylesheet" href="css/main.css?v=3.8">
</head>
<body>
  <div id="app" class="app">
    
    <!-- Header -->
    <header class="header">
      <div class="header__container">
        <a href="#/" class="header__logo">
          <img src="assets/logo.png" alt="–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç" class="header__logo-img">
          <span class="header__logo-text">–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç</span>
        </a>
        <nav id="main-nav" class="header__nav">
          <a href="#/" class="nav-link">–ù–∞—á–∞–ª–æ</a>
          <a href="#/booking" class="nav-link">–ó–∞–ø–∞–∑–∏ —á–∞—Å</a>
          <a href="#/admin" class="nav-link nav-link--admin">–í—Ö–æ–¥</a>
        </nav>
        <button id="menu-toggle" class="header__menu-btn" aria-label="–ú–µ–Ω—é">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </header>

    <!-- Mobile Navigation -->
    <div id="mobile-nav" class="mobile-nav" hidden>
      <div class="mobile-nav__backdrop"></div>
      <nav class="mobile-nav__drawer">
        <a href="#/" class="nav-link">–ù–∞—á–∞–ª–æ</a>
        <a href="#/booking" class="nav-link">–ó–∞–ø–∞–∑–∏ —á–∞—Å</a>
        <a href="#/admin" class="nav-link">–í—Ö–æ–¥</a>
      </nav>
    </div>

    <!-- Main Content -->
    <main id="main-content" class="main">
      <!-- Content loaded by router -->
    </main>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Offline Indicator -->
    <div id="offline-indicator" class="offline-indicator" hidden>
      <span>üì°</span>
      <span>–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º</span>
      <span id="pending-sync" class="pending-badge" hidden>0</span>
    </div>

  </div>

  <!-- Templates -->
  
  <!-- Home Page Template -->
  <template id="page-home">
    <div class="page page--home">
      <section class="hero">
        <img src="assets/logo.png" alt="–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç" class="hero__logo">
        <h1>–î–æ–±—Ä–µ –¥–æ—à–ª–∏ –≤<br><span class="hero__brand">–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç</span></h1>
        <p class="hero__subtitle">–í–∞—à–∞—Ç–∞ —É—Å–º–∏–≤–∫–∞ –µ –Ω–∞—à–∞—Ç–∞ –≥—Ä–∏–∂–∞</p>
        <a href="#/booking" class="btn btn--primary btn--lg">
          üìÖ –ó–∞–ø–∞–∑–µ—Ç–µ —á–∞—Å –æ–Ω–ª–∞–π–Ω
        </a>
      </section>
      
      <section class="info-cards">
        <div class="info-card">
          <span class="info-card__icon">üïê</span>
          <h3>–†–∞–±–æ—Ç–Ω–æ –≤—Ä–µ–º–µ</h3>
          <p>–ü–æ–Ω - –ü–µ—Ç: 09:00 - 12:00<br>13:30 - 17:00</p>
        </div>
        <div class="info-card">
          <span class="info-card__icon">üìç</span>
          <h3>–ê–¥—Ä–µ—Å</h3>
          <p>–≥—Ä. –°–º–æ–ª—è–Ω<br>—É–ª. "–†–æ–¥–æ–ø–∏" 1</p>
        </div>
        <div class="info-card">
          <span class="info-card__icon">üìû</span>
          <h3>–¢–µ–ª–µ—Ñ–æ–Ω</h3>
          <p>0888 123 456</p>
        </div>
      </section>
    </div>
  </template>

  <!-- Booking Page Template -->
  <template id="page-booking">
    <div class="page page--booking">
      <div class="booking-header">
        <h1>üìÖ –ó–∞–ø–∞–∑–µ—Ç–µ —á–∞—Å</h1>
        <p class="booking-subtitle">–ò–∑–±–µ—Ä–µ—Ç–µ —É–¥–æ–±–Ω–∞ –∑–∞ –≤–∞—Å –¥–∞—Ç–∞ –∏ —á–∞—Å</p>
      </div>
      <div class="booking-container">
        <div class="booking-calendar" id="booking-calendar">
          <!-- Calendar will be rendered here -->
        </div>
        <div class="booking-slots" id="booking-slots">
          <div class="slots-placeholder">
            <span class="slots-icon">üìÜ</span>
            <p>–ò–∑–±–µ—Ä–µ—Ç–µ –¥–∞—Ç–∞ –æ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä–∞</p>
          </div>
        </div>
      </div>
      <form id="booking-form" class="booking-form" hidden>
        <h3>üìù –í–∞—à–∏—Ç–µ –¥–∞–Ω–Ω–∏</h3>
        <div class="form-row">
          <div class="form-group">
            <label for="patient-name">–ò–º–µ –∏ —Ñ–∞–º–∏–ª–∏—è *</label>
            <input type="text" id="patient-name" name="patientName" placeholder="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" required>
          </div>
          <div class="form-group">
            <label for="patient-phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
            <input type="tel" id="patient-phone" name="patientPhone" placeholder="0888 123 456" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group form-group--full">
            <label for="patient-reason">–ü—Ä–∏—á–∏–Ω–∞ –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ—Ç–æ</label>
            <textarea id="patient-reason" name="reason" rows="2" placeholder="–ü—Ä–µ–≥–ª–µ–¥, –±–æ–ª–∫–∞, –ø–æ—á–∏—Å—Ç–≤–∞–Ω–µ..."></textarea>
          </div>
        </div>
        <div class="booking-summary" id="booking-summary">
          <!-- Summary will appear here -->
        </div>
        <button type="submit" class="btn btn--primary btn--lg btn--block">
          ‚úì –ü–æ—Ç–≤—ä—Ä–¥–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—è—Ç–∞
        </button>
      </form>
    </div>
  </template>

  <!-- Admin Login Template -->
  <template id="page-admin-login">
    <div class="page page--login">
      <div class="login-card">
        <div class="login-logo">
          <img src="assets/logo.png" alt="–†–æ–¥–æ–ø–∏ –î–µ–Ω—Ç" class="login-logo__img">
        </div>
        <h1>üîê –í—Ö–æ–¥ –∑–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</h1>
        <p class="login-subtitle">–í–ª–µ–∑—Ç–µ —Å –≤–∞—à–∏—è Google –∞–∫–∞—É–Ω—Ç</p>
        
        <button id="google-login-btn" class="btn btn--google">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          –í—Ö–æ–¥ —Å Google
        </button>
        
        <div id="google-signin-container" class="google-signin-container"></div>
        
        <p class="login-note">–°–∞–º–æ –æ—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –º–æ–≥–∞—Ç –¥–∞ –≤–ª—è–∑–∞—Ç</p>
      </div>
    </div>
  </template>

  <!-- Admin Dashboard Template -->
  <template id="page-admin-dashboard">
    <div class="page page--admin page--dashboard">
      <div class="admin-header">
        <h1>üìä –¢–∞–±–ª–æ</h1>
        <button id="logout-btn" class="btn btn--outline">–ò–∑—Ö–æ–¥</button>
      </div>
      <nav class="admin-nav">
        <a href="#/admin/dashboard" class="admin-nav__link active">–¢–∞–±–ª–æ</a>
        <a href="#/admin/workday" class="admin-nav__link">–†–∞–±–æ—Ç–µ–Ω –¥–µ–Ω</a>
        <a href="#/admin/calendar" class="admin-nav__link">üìÜ –ö–∞–ª–µ–Ω–¥–∞—Ä</a>
        <a href="#/admin/settings" class="admin-nav__link">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
      </nav>
      <div class="admin-content">
        <!-- Date Range Selector -->
        <div class="dashboard-period-selector" style="display:flex;gap:12px;flex-wrap:wrap;margin-bottom:24px;">
          <button type="button" class="period-btn active" data-period="today" style="padding:16px 28px;font-size:16px;font-weight:600;border-radius:16px;border:2px solid #e2e8f0;background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:white;cursor:pointer;box-shadow:0 6px 20px rgba(37,99,235,0.4);">üìÖ –î–Ω–µ—Å</button>
          <button type="button" class="period-btn" data-period="week" style="padding:16px 28px;font-size:16px;font-weight:600;border-radius:16px;border:2px solid #e2e8f0;background:white;color:#475569;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,0.06);">üìÜ –°–µ–¥–º–∏—Ü–∞</button>
          <button type="button" class="period-btn" data-period="month" style="padding:16px 28px;font-size:16px;font-weight:600;border-radius:16px;border:2px solid #e2e8f0;background:white;color:#475569;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,0.06);">üóìÔ∏è –ú–µ—Å–µ—Ü</button>
          <button type="button" class="period-btn" data-period="custom" style="padding:16px 28px;font-size:16px;font-weight:600;border-radius:16px;border:2px solid #e2e8f0;background:white;color:#475569;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,0.06);">üìä –ü–µ—Ä–∏–æ–¥</button>
        </div>
        <div id="custom-date-range" class="custom-date-range" hidden style="display:none;gap:16px;background:white;padding:20px;border-radius:16px;border:2px solid #e2e8f0;box-shadow:0 4px 12px rgba(0,0,0,0.08);margin-bottom:24px;flex-wrap:wrap;align-items:center;">
          <div style="display:flex;align-items:center;gap:10px;">
            <label style="font-weight:600;color:#475569;">–û—Ç:</label>
            <input type="date" id="date-from" style="padding:12px 16px;border:2px solid #cbd5e1;border-radius:12px;font-size:15px;background:#f8fafc;" />
          </div>
          <span style="color:#94a3b8;font-weight:700;font-size:24px;">‚Üí</span>
          <div style="display:flex;align-items:center;gap:10px;">
            <label style="font-weight:600;color:#475569;">–î–æ:</label>
            <input type="date" id="date-to" style="padding:12px 16px;border:2px solid #cbd5e1;border-radius:12px;font-size:15px;background:#f8fafc;" />
          </div>
          <button type="button" class="btn btn--primary" id="apply-date-range" style="padding:12px 24px;background:#3b82f6;color:white;border:none;border-radius:12px;font-weight:600;cursor:pointer;">‚úì –ü—Ä–∏–ª–æ–∂–∏</button>
        </div>
        
        <!-- Patient Search -->
        <div class="patient-search-box" style="display:flex;gap:12px;background:white;padding:16px 20px;border-radius:16px;border:2px solid #e2e8f0;box-shadow:0 4px 12px rgba(0,0,0,0.08);margin-bottom:24px;align-items:center;flex-wrap:wrap;">
          <span style="font-size:20px;">üîç</span>
          <input type="text" id="patient-search" placeholder="–¢—ä—Ä—Å–∏ –ø–∞—Ü–∏–µ–Ω—Ç –ø–æ –∏–º–µ..." style="flex:1;min-width:200px;padding:12px 16px;border:2px solid #cbd5e1;border-radius:12px;font-size:15px;background:#f8fafc;" />
          <button type="button" class="btn btn--primary" id="search-patient-btn" style="padding:12px 24px;background:#22c55e;color:white;border:none;border-radius:12px;font-weight:600;cursor:pointer;">–¢—ä—Ä—Å–∏</button>
          <button type="button" class="btn btn--outline" id="clear-search-btn" style="padding:12px 24px;background:white;color:#475569;border:2px solid #e2e8f0;border-radius:12px;font-weight:600;cursor:pointer;" hidden>‚úï –ò–∑—á–∏—Å—Ç–∏</button>
        </div>
        
        <!-- Finance Stats -->
        <div class="stats-grid stats-grid--finance">
          <div class="stat-card stat-card--income">
            <span class="stat-card__icon">üí∞</span>
            <span class="stat-card__value" id="stat-income">0.00 ‚Ç¨</span>
            <span class="stat-card__label">–ü—Ä–∏—Ö–æ–¥–∏</span>
          </div>
          <div class="stat-card stat-card--expense">
            <span class="stat-card__icon">üí∏</span>
            <span class="stat-card__value" id="stat-expense">0.00 ‚Ç¨</span>
            <span class="stat-card__label">–†–∞–∑—Ö–æ–¥–∏</span>
          </div>
          <div class="stat-card stat-card--balance">
            <span class="stat-card__icon">üìà</span>
            <span class="stat-card__value" id="stat-balance">0.00 ‚Ç¨</span>
            <span class="stat-card__label">–ë–∞–ª–∞–Ω—Å</span>
          </div>
          <div class="stat-card stat-card--patients">
            <span class="stat-card__icon">üë•</span>
            <span class="stat-card__value" id="stat-patients">0</span>
            <span class="stat-card__label">–ü–∞—Ü–∏–µ–Ω—Ç–∏</span>
          </div>
        </div>
        
        <!-- Finance Breakdown -->
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <h3>üí∞ –ü—Ä–∏—Ö–æ–¥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
            <div id="income-breakdown" class="breakdown-list">
              <p class="text-muted">–ó–∞—Ä–µ–∂–¥–∞–Ω–µ...</p>
            </div>
          </div>
          <div class="dashboard-card">
            <h3>üí∏ –†–∞–∑—Ö–æ–¥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
            <div id="expense-breakdown" class="breakdown-list">
              <p class="text-muted">–ó–∞—Ä–µ–∂–¥–∞–Ω–µ...</p>
            </div>
          </div>
        </div>
        
        <!-- Records for Period -->
        <div class="dashboard-card dashboard-card--full">
          <h3 id="records-title">üìã –ó–∞–ø–∏—Å–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥–∞</h3>
          <div id="recent-records" class="records-list">
            <p class="text-muted">–ó–∞—Ä–µ–∂–¥–∞–Ω–µ...</p>
          </div>
        </div>
      </div>
    </div>
  </template>

  <!-- Scripts -->
  <script src="js/config.js?v=3.8"></script>
  <script src="js/utils.js?v=3.8"></script>
  <script src="js/api.js?v=3.8"></script>
  <script src="js/router.js?v=3.8"></script>
  <script src="js/auth.js?v=3.8"></script>
  <script src="js/calendar.js?v=3.8"></script>
  <script src="js/app.js?v=3.8"></script>
  
  <!-- Register Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => console.log('SW registered'))
          .catch(err => console.log('SW registration failed:', err));
      });
    }
  </script>
</body>
</html>
